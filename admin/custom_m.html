<script type="text/x-iobroker" data-template-name="valuetrackerovertime" >
    
    <div class="row">
	<div class="col s2">
			<input type="checkbox" data-field="enabled"/>
			<span class="translate">enabled</span>
    </div>
    <div class="input-field col s6">
      <input placeholder="Leave empty to use object's name" type="text" data-field="alias" />
			<span class="translate">alias</span>
    </div>
    <div class="input-field col s2">
      <input placeholder="Leave empty to use object's unit" type="text" data-field="output_unit" />
			<span class="translate">output unit</span>
    </div>
	<div class="col s2">
      <input data-field="output_multiplier" type="number" data-default="1" />
			<span class="translate">output Multiplier</span>
	</div>
		
</div>


<!-- insert hier custom_m_h.html -->
<p class=" translate title">Detailed history</p>
<div class="row">
    <span class="translate">Create seperate datapoints for every timeframe (useful for users)</span>

</div>

<div class="row">
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_days" data-field="detailed_days" />
        <span for="detailed_days" class="translate">Every day <small>(~365 datapoints per year)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_DetailedDays.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_weeks" data-field="detailed_weeks" />
        <span class="translate">Every week <small>(~53 datapoints per year)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_DetailedWeeks.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_months" data-field="detailed_months" />
        <span class="translate">Every month <small>(12 datapoints per year)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_DetailedMonths.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_quarters" data-field="detailed_quarters" />
        <span class="translate">Every quarter <small>(4 datapoints per year)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_DetailedQuarters.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_years" data-field="detailed_years" />
        <span class="translate">Every year <small>(1 Datapoints per year)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_DetailedYears.PNG" />
        </span>
    </div>

</div>
<p class=" translate title">Detailed current</p>
<div class="row">
    <span class="translate">Overrides Data after new Timeframe (useful for Scripts like PowerUsageOnMonday or
        PowerUsageInDecember)</span>
</div>
<div class="row">
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_current_days" data-field="detailed_current_days" />
        <span for="detailed_days" class="translate">Weekdays Mo-Su <small>(7 datapoints)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_detailed_current_days.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_current_weeks" data-field="detailed_current_weeks" />
        <span class="translate">Weeks in the last 12 months <small>(~53 datapoints)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_detailed_current_weeks.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_current_months" data-field="detailed_current_months" />
        <span class="translate">Months in the last 12 months <small>(12 datapoints)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_detailed_current_months.PNG" />
        </span>
    </div>
    <div class="col  input-field mytooltip">
        <input type="checkbox" class="value" id="detailed_current_quarters" data-field="detailed_current_quarters" />
        <span class="translate">quarters in the last 12 months <small>(4 datapoints)</small></span>
        <span class="mytooltiptext">
            <span>example: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_detailed_current_quarters.PNG" />
        </span>
    </div>
</div>

<p class=" translate title">Current / previous data</p>
<div class="row">
    <div class="col mytooltip">
        <span class="translate">-1 = no data collected (also no current), 0 = only current timeframe, > 0 the timeframes
            before (useful for Scripts like PowerUsageToday, PowerUsageYesterday or PowerUsageLastYear) </span>
        <span class="mytooltiptext">
            <span>example before >= 0: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_Current.PNG" />
            <br />
            <span>example before >= 1: </span>
            <img src="/adapter/valuetrackerovertime/VTOT_Setting_Before.png" />
        </span>
    </div>
</div>
<div class="row">
    <div class="col s2 input-field">
        <input type="number" class="value" id="before_minutes" data-field="before_minutes" />
        <span class="translate">Keep previous minutes</span>
    </div>
    <div class="col s2 input-field">
        <input type="number" class="value" id="before_hours" data-field="before_hours" />
        <span class="translate">Keep previous hours</span>
    </div>

</div>
<div class="row">

    <div class="col s2 input-field">
        <input type="number" class="value" id="before_days" data-field="before_days" />
        <span class="translate">Keep previous days</span>
    </div>
    <div class="col s2 input-field">
        <input type="number" class="value" id="before_weeks" data-field="before_weeks" />
        <span class="translate">Keep previous weeks</span>
    </div>
    <div class="col s2 input-field">
        <input type="number" class="value" id="before_months" data-field="before_months" />
        <span class="translate">Keep previous months</span>
    </div>
    <div class="col s2 input-field">
        <input type="number" class="value" id="before_quarters" data-field="before_quarters" />
        <span class="translate">Keep previous quarters</span>
    </div>
    <div class="col s2 input-field">
        <input type="number" class="value" id="before_years" data-field="before_years" />
        <span class="translate">Keep previous years</span>
    </div>

</div>
<p class=" translate title">Counter reset detection</p>
<div class="row">
    <div class="col s3 input-field">
        <input type="checkbox" class="value" id="counterResetDetection" data-field="counterResetDetection" />
        <span class="translate">Enable counter reset detection</span>
    </div>
    <div class="col s3 input-field">
        <input type="number" class="value" id="counterResetDetetion_CountAfterReset"
            data-field="counterResetDetetion_CountAfterReset" />
        <span class="translate">Ignore values lower then the last good value</span>
    </div>

</div>

<p class=" translate title">History readout (Experimental)</p>

<div class="row">
    <div class="col s4 input-field ">
        <input type="checkbox" class="value onlyinCustom" id="history_work" data-field="history_work" />
        <span class="translate">readout history no</b></span>
        <input type="text" class="value onlyinCustom" id="historyInstanz" data-field="historyInstanz" />
        <span class="translate">Use the data from this history instance, these adapters should work: sql.x or influxdb.x
            or history.x</span>
    </div>
    <div class="col s2 input-field">
        <input type="checkbox" class="value" id="history_detailed" data-field="history_detailed" />
        <span class="translate">readout detailed</b></span>
        <br>
        <input type="checkbox" class="value" id="history_before" data-field="history_before" />
        <span class="translate">readout before</b></span>
        <br>
        <input type="checkbox" class="value" id="history_startvalues" data-field="history_startvalues" />
        <span class="translate">readout startvalues</b></span>
    </div>
    <div class="col s2 input-field">
        <input placeholder="Leave empty to use the history Read Instanz" type="text" id="historywrite_Instanz"
            data-field="history_writeInstanz" />
        <span class="translate">history_writeInstanz</span>
        
    </div>
    <div class="col s4 input-field">
       <row>
        <input type="checkbox" class="value" id="historywrite_Enabled_Day" data-field="historywrite_Enabled_Day" />
        <span class="translate">fill 01_current_Day history</span>

        <input type="number" class="value" style="width:100px" id="historywrite_MinChange_Day" data-field="historywrite_MinChange_Day" />
        <span class="translate">Min Delta</span>
       </row>     
       <row>
        <input type="checkbox" class="value" id="historywrite_Enabled_Week" data-field="historywrite_Enabled_Week" />
        <span class="translate">fill 02_current_Week history</span>

        <input type="number" class="value" style="width:100px" id="historywrite_MinChange_Week" data-field="historywrite_MinChange_Week" />
        <span class="translate">Min Delta</span>
       </row> 
       <row>
        <input type="checkbox" class="value" id="historywrite_Enabled_Month" data-field="historywrite_Enabled_Month" />
        <span class="translate">fill 03_current_Month history</span>

        <input type="number" class="value" style="width:100px" id="historywrite_MinChange_Month" data-field="historywrite_MinChange_Month" />
        <span class="translate">Min Delta</span>
       </row> 
       <row>
        <input type="checkbox" class="value" id="historywrite_Enabled_Quarter" data-field="historywrite_Enabled_Quarter" />
        <span class="translate">fill 04_current_Quarter history</span>

        <input type="number" class="value" style="width:100px" id="historywrite_MinChange_Quarter" data-field="historywrite_MinChange_Quarter" />
        <span class="translate">Min Delta</span>
       </row> 
       <row>
        <input type="checkbox" class="value" id="historywrite_Enabled_Year" data-field="historywrite_Enabled_Year" />
        <span class="translate">fill 05_current_Year history</span>

        <input type="number" class="value" style="width:100px;text-align:right;" id="historywrite_MinChange_Year" data-field="historywrite_MinChange_Year" />
        <span class="translate">Min Delta</span>
       </row> 
    </div>

</div>

<style>
    .mytooltip {
        border-bottom: 1px dotted black;
    }

    .mytooltip .mytooltiptext {
        transition: 0s;
        visibility: hidden;
        background-color: black;
        color: #fff;
        text-align: left;
        font-size: large;
        border-radius: 6px;
        padding: 10px;

        /* Position the tooltip */
        position: absolute;
        z-index: 1;
        top: 100%;
        left: 0%;
        margin-left: 10px;
    }

    .mytooltip:hover .mytooltiptext {
        visibility: visible;
        transition-delay: 0.3s;
    }
</style>


</script>


<script type="text/javascript">
          

 $.get("adapter/valuetrackerovertime/words.js", function (script) {
    let translation = script.substring(script.indexOf('{'), script.length);
    translation = translation.substring(0, translation.lastIndexOf(';'));
    $.extend(systemDictionary, JSON.parse(translation));
  });




  // There are two ways how to predefine default settings:
  // - with attribute "data-default" (content independent)
  // - with function in global variable "defaults". Function name is equal with adapter name.
  //   as input function receives object with all information concerning it
  if (typeof defaults !== 'undefined') {
    defaults["valuetrackerovertime"] = function (obj, instanceObj) {
      return {
        enabled: false,
        alias: null,
        output_unit: null,
        output_multiplier: 1,
        detailed_days: instanceObj.native.detailed_days,
        detailed_weeks: instanceObj.native.detailed_weeks,
        detailed_months: instanceObj.native.detailed_months,
        detailed_years: instanceObj.native.detailed_years,
        detailed_current_days: instanceObj.native.detailed_current_days,
        detailed_current_weeks: instanceObj.native.detailed_current_weeks,
        detailed_current_months: instanceObj.native.detailed_current_months,
        detailed_current_quarters: instanceObj.native.detailed_current_quarters,
        before_minutes: instanceObj.native.before_minutes,
        before_hours: instanceObj.native.before_hours,
        before_days: instanceObj.native.before_days,
        before_weeks: instanceObj.native.before_weeks,
        before_months: instanceObj.native.before_months,
        before_quarters: instanceObj.native.before_quarters,
        before_years: instanceObj.native.before_years,
        counterResetDetection: instanceObj.native.counterResetDetection,
        counterResetDetetion_CountAfterReset: instanceObj.native.counterResetDetetion_CountAfterReset,
        historyInstanz: instanceObj.native.historyInstanz,
        historyload_Detailed: false,
        historywrite_MinChange_Year: 3


      };
    }
  }
</script>